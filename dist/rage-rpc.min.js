!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports=n():e.rpc=n()}("undefined"!=typeof self?self:this,(function(){return function(e){var n={};function r(t){if(n[t])return n[t].exports;var o=n[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=n,r.d=function(e,n,t){r.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,n){if(1&n&&(e=r(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(r.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var o in e)r.d(t,o,function(n){return e[n]}.bind(null,o));return t},r.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(n,"a",n),n},r.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},r.p="",r(r.s=1)}([function(e,n,r){"use strict";var t;function o(e,n){const r="client"===c();if(e&&"object"==typeof e&&void 0!==e.id){const o=(n,t,o)=>r?e.type===n&&t.at(e.id)===e:e instanceof o;switch(n){case t.Blip:return o("blip",mp.blips,mp.Blip);case t.Checkpoint:return o("checkpoint",mp.checkpoints,mp.Checkpoint);case t.Colshape:return o("colshape",mp.colshapes,mp.Colshape);case t.Label:return o("textlabel",mp.labels,mp.TextLabel);case t.Marker:return o("marker",mp.markers,mp.Marker);case t.Object:return o("object",mp.objects,mp.Object);case t.Pickup:return o("pickup",mp.pickups,mp.Pickup);case t.Player:return o("player",mp.players,mp.Player);case t.Vehicle:return o("vehicle",mp.vehicles,mp.Vehicle)}}return!1}function i(){const e=46656*Math.random()|0,n=46656*Math.random()|0;return("000"+e.toString(36)).slice(-3)+("000"+n.toString(36)).slice(-3)}function c(){try{return mp.joaat?"server":mp.game&&mp.game.joaat?"client":mp.trigger?"cef":"unknown"}catch(e){return"unknown"}}function s(e){const n=c();return JSON.stringify(e,(e,r)=>{if("client"===n||"server"===n&&r&&"object"==typeof r){let e;if(o(r,t.Blip)?e=t.Blip:o(r,t.Checkpoint)?e=t.Checkpoint:o(r,t.Colshape)?e=t.Colshape:o(r,t.Marker)?e=t.Marker:o(r,t.Object)?e=t.Object:o(r,t.Pickup)?e=t.Pickup:o(r,t.Player)?e=t.Player:o(r,t.Vehicle)&&(e=t.Vehicle),e)return{__t:e,i:"number"==typeof r.remoteId?r.remoteId:r.id}}return r})}function a(e){const n=c();return JSON.parse(e,(e,r)=>{if(("client"===n||"server"===n)&&r&&"object"==typeof r&&"string"==typeof r.__t&&"number"==typeof r.i&&2===Object.keys(r).length){const e=r.i;let o;switch(r.__t){case t.Blip:o=mp.blips;break;case t.Checkpoint:o=mp.checkpoints;break;case t.Colshape:o=mp.colshapes;break;case t.Label:o=mp.labels;break;case t.Marker:o=mp.markers;break;case t.Object:o=mp.objects;break;case t.Pickup:o=mp.pickups;break;case t.Player:o=mp.players;break;case t.Vehicle:o=mp.vehicles}if(o)return o["client"===n?"atRemoteId":"at"](e)}return r})}function l(e){return new Promise(n=>n(e))}function u(e){return new Promise((n,r)=>r(e))}function p(e,n){return"number"==typeof n?Promise.race([new Promise((e,r)=>{setTimeout(()=>r("TIMEOUT"),n)}),e]):e}function f(e){try{e.url}catch(e){return!1}return!0}function g(e,n){const r=Math.ceil(e.length/n),t=new Array(r);let o=0;for(let i=0;i<r;i+=1)t[i]=e.substr(o,n),o+=n;return t}r.d(n,"i",(function(){return i})),r.d(n,"b",(function(){return c})),r.d(n,"h",(function(){return s})),r.d(n,"d",(function(){return a})),r.d(n,"f",(function(){return l})),r.d(n,"e",(function(){return u})),r.d(n,"g",(function(){return p})),r.d(n,"c",(function(){return f})),r.d(n,"a",(function(){return g})),function(e){e.Blip="b",e.Checkpoint="cp",e.Colshape="c",e.Label="l",e.Marker="m",e.Object="o",e.Pickup="p",e.Player="pl",e.Vehicle="v"}(t||(t={}))},function(e,n,r){"use strict";r.r(n),function(e){r.d(n,"register",(function(){return _})),r.d(n,"unregister",(function(){return v})),r.d(n,"call",(function(){return b})),r.d(n,"callServer",(function(){return y})),r.d(n,"callClient",(function(){return R})),r.d(n,"callBrowsers",(function(){return j})),r.d(n,"callBrowser",(function(){return E})),r.d(n,"on",(function(){return C})),r.d(n,"off",(function(){return S})),r.d(n,"trigger",(function(){return U})),r.d(n,"triggerClient",(function(){return A})),r.d(n,"triggerServer",(function(){return G})),r.d(n,"triggerBrowsers",(function(){return M})),r.d(n,"triggerBrowser",(function(){return L}));var t=r(0);const o=t.b();if(!o)throw"Unknown RAGE environment";const i="PROCEDURE_NOT_FOUND",c=32e3,s="__rpc:id",a="__rpc:process",l="__rpc:processPartial",u="__rpc:browserRegister",p="__rpc:browserUnregister",f="__rpc:triggerEvent",g="__rpc:triggerEventBrowsers",m="cef"===o?window:e;if(m[l]||(m.__rpcPartialData={},m[l]=(e,n,r,t,i)=>{"unknown"!==o&&("server"!==o&&(i=t,t=r,r=n,n=e),m.__rpcPartialData[n]||(m.__rpcPartialData[n]=new Array(t)),m.__rpcPartialData[n][r]=i,m.__rpcPartialData[n].includes(void 0)||("server"!==o?m[a](m.__rpcPartialData[n].join("")):m[a](e,m.__rpcPartialData[n].join("")),delete m.__rpcPartialData[n]))}),!m[a]){if(m.__rpcListeners={},m.__rpcPending={},m.__rpcEvListeners={},m[a]=(e,n)=>{if("unknown"===o)return;"server"!==o&&(n=e);const r=t.d(n);if(r.req){const n={id:r.id,environment:r.fenv||r.env};"server"===o&&(n.player=e);const i={ret:1,id:r.id,env:o};let c;switch(o){case"server":c=e=>n.player.call(a,[t.h(e)]);break;case"client":if("server"===r.env)c=e=>mp.events.callRemote(a,t.h(e));else if("cef"===r.env){const e=r.b&&m.__rpcBrowsers[r.b];n.browser=e,c=n=>e&&t.c(e)&&w(e,n,!0)}break;case"cef":c=e=>mp.trigger(a,t.h(e))}if(c){const e=h(r.name,r.args,n);r.noRet||e.then(e=>c({...i,res:e})).catch(e=>c({...i,err:e||null}))}}else if(r.ret){const n=m.__rpcPending[r.id];if("server"===o&&n.player!==e)return;n&&(n.resolve(r.hasOwnProperty("err")?t.e(r.err):t.f(r.res)),delete m.__rpcPending[r.id])}},"cef"!==o&&"unknown"!==o){if(mp.events.add(a,m[a]),mp.events.add(l,m[l]),"client"===o){_("__rpc:callServer",([e,n,r],t)=>k(e,n,{fenv:t.environment,noRet:r})),_("__rpc:callBrowsers",([e,n,r],t)=>x(null,e,n,{fenv:t.environment,noRet:r})),m.__rpcBrowsers={};const e=e=>{const n=t.i();Object.keys(m.__rpcBrowsers).forEach(n=>{const r=m.__rpcBrowsers[n];r&&t.c(r)&&r!==e||delete m.__rpcBrowsers[n]}),m.__rpcBrowsers[n]=e,e.execute(`\n                    window.name = '${n}';\n                    if(typeof window['${s}'] === 'undefined'){\n                        window['${s}'] = Promise.resolve(window.name);\n                    }else{\n                        window['${s}:resolve'](window.name);\n                    }\n                `)};mp.browsers.forEach(e),mp.events.add("browserCreated",e),m.__rpcBrowserProcedures={},mp.events.add(u,e=>{const[n,r]=JSON.parse(e);m.__rpcBrowserProcedures[r]=n}),mp.events.add(p,e=>{const[n,r]=JSON.parse(e);m.__rpcBrowserProcedures[r]===n&&delete m.__rpcBrowserProcedures[r]}),_(g,([e,n],r)=>{Object.keys(m.__rpcBrowsers).forEach(o=>{const i=m.__rpcBrowsers[o];i&&t.c(i)?B(i,f,[e,n],{fenv:r.environment,noRet:1}):delete m.__rpcBrowsers[o]})})}}else"unknown"!==o&&void 0===m[s]&&(m[s]=new Promise(e=>{window.name?e(window.name):m[s+":resolve"]=e}));_(f,([e,n],r)=>O(e,n,r))}function w(e,n,r){const o=t.h(n);e.execute(`var process = window["${a}"]; if(process){ process(${JSON.stringify(o)}); }else{ ${r?"":`mp.trigger("${a}", '{"ret":1,"id":"${n.id}","err":"${i}","env":"cef"}');`} }`)}function h(e,n,r){const o=m.__rpcListeners[e];return o?t.f(o(n,r)):t.e(i)}function d(e,n){const r={client:(e,...n)=>mp.events.callRemote(e,...n),server:(e,...r)=>n.call(e,[...r])},o=e.env,i=t.h(e);if(i.length>c){const n=t.a(i,c);n.forEach((t,i)=>{r[o](l,e.id,i,n.length,t)})}else r[o](a,i)}function _(e,n){if("unknown"===o)throw"Unknown RAGE environment";if(2!==arguments.length)throw'register expects 2 arguments: "name" and "cb"';return"cef"===o&&m[s].then(n=>mp.trigger(u,JSON.stringify([n,e]))),m.__rpcListeners[e]=n,()=>v(e)}function v(e){if("unknown"===o)throw"Unknown RAGE environment";if(1!==arguments.length)throw'unregister expects 1 argument: "name"';"cef"===o&&m[s].then(n=>mp.trigger(p,JSON.stringify([n,e]))),m.__rpcListeners[e]=void 0}function b(e,n,r={}){if("unknown"===o)throw"Unknown RAGE environment";return arguments.length<1||arguments.length>3?t.e('call expects 1 to 3 arguments: "name", optional "args", and optional "options"'):t.g(h(e,n,{environment:o}),r.timeout)}function k(e,n,r={}){switch(o){case"server":return b(e,n);case"client":{const i=t.i();return new Promise(t=>{r.noRet||(m.__rpcPending[i]={resolve:t}),d({req:1,id:i,name:e,env:o,args:n,...r})})}case"cef":return R("__rpc:callServer",[e,n,+r.noRet])}}function y(e,n,r={}){if("unknown"===o)throw"Unknown RAGE environment";if(arguments.length<1||arguments.length>3)return t.e('callServer expects 1 to 3 arguments: "name", optional "args", and optional "options"');let i={};return r.noRet&&(i.noRet=1),t.g(k(e,n,i),r.timeout)}function P(e,n,r,i={}){switch(o){case"client":return b(n,r);case"server":{const c=t.i();return new Promise(t=>{i.noRet||(m.__rpcPending[c]={resolve:t,player:e}),d({req:1,id:c,name:n,env:o,args:r,...i},e)})}case"cef":{const e=t.i();return m[s].then(c=>new Promise(s=>{i.noRet||(m.__rpcPending[e]={resolve:s});const l={b:c,req:1,id:e,name:n,env:o,args:r,...i};mp.trigger(a,t.h(l))}))}}}function R(e,n,r,i={}){if("unknown"===o)throw"Unknown RAGE environment";switch(o){case"client":if(i=r||{},r=n,n=e,e=null,arguments.length<1||arguments.length>3||"string"!=typeof n)return t.e('callClient from the client expects 1 to 3 arguments: "name", optional "args", and optional "options"');break;case"server":if(arguments.length<2||arguments.length>4||"object"!=typeof e)return t.e('callClient from the server expects 2 to 4 arguments: "player", "name", optional "args", and optional "options"');break;case"cef":if(i=r||{},r=n,n=e,e=null,arguments.length<1||arguments.length>3||"string"!=typeof n)return t.e('callClient from the browser expects 1 to 3 arguments: "name", optional "args", and optional "options"')}let c={};return i.noRet&&(c.noRet=1),t.g(P(e,n,r,c),i.timeout)}function B(e,n,r,i={}){return new Promise(c=>{const s=t.i();i.noRet||(m.__rpcPending[s]={resolve:c}),w(e,{req:1,id:s,name:n,env:o,args:r,...i},!1)})}function x(e,n,r,c={}){switch(o){case"client":const o=m.__rpcBrowserProcedures[n];if(!o)return t.e(i);const s=m.__rpcBrowsers[o];return s&&t.c(s)?B(s,n,r,c):t.e(i);case"server":return P(e,"__rpc:callBrowsers",[n,r,+c.noRet],c);case"cef":return P(null,"__rpc:callBrowsers",[n,r,+c.noRet],c)}}function j(e,n,r,i={}){if("unknown"===o)throw"Unknown RAGE environment";let c,s={};switch(o){case"client":case"cef":if(i=r||{},r=n,n=e,arguments.length<1||arguments.length>3)return t.e('callBrowsers from the client or browser expects 1 to 3 arguments: "name", optional "args", and optional "options"');i.noRet&&(s.noRet=1),c=x(null,n,r,s);break;case"server":if(arguments.length<2||arguments.length>4)return t.e('callBrowsers from the server expects 2 to 4 arguments: "player", "name", optional "args", and optional "options"');i.noRet&&(s.noRet=1),c=x(e,n,r,s)}if(c)return t.g(c,i.timeout)}function E(e,n,r,i={}){if("unknown"===o)throw"Unknown RAGE environment";if("client"!==o)return t.e("callBrowser can only be used in the client environment");if(arguments.length<2||arguments.length>4)return t.e('callBrowser expects 2 to 4 arguments: "browser", "name", optional "args", and optional "options"');let c={};return i.noRet&&(c.noRet=1),t.g(B(e,n,r,c),i.timeout)}function O(e,n,r){const t=m.__rpcEvListeners[e];t&&t.forEach(e=>e(n,r))}function C(e,n){if("unknown"===o)throw"Unknown RAGE environment";if(2!==arguments.length)throw'on expects 2 arguments: "name" and "cb"';const r=m.__rpcEvListeners[e]||new Set;return r.add(n),m.__rpcEvListeners[e]=r,()=>S(e,n)}function S(e,n){if("unknown"===o)throw"Unknown RAGE environment";if(2!==arguments.length)throw'off expects 2 arguments: "name" and "cb"';const r=m.__rpcEvListeners[e];r&&r.delete(n)}function U(e,n){if("unknown"===o)throw"Unknown RAGE environment";if(arguments.length<1||arguments.length>2)throw'trigger expects 1 or 2 arguments: "name", and optional "args"';O(e,n,{environment:o})}function A(e,n,r){if("unknown"===o)throw"Unknown RAGE environment";switch(o){case"client":if(r=n,n=e,e=null,arguments.length<1||arguments.length>2||"string"!=typeof n)throw'triggerClient from the client expects 1 or 2 arguments: "name", and optional "args"';break;case"server":if(arguments.length<2||arguments.length>3||"object"!=typeof e)throw'triggerClient from the server expects 2 or 3 arguments: "player", "name", and optional "args"';break;case"cef":if(r=n,n=e,e=null,arguments.length<1||arguments.length>2||"string"!=typeof n)throw'triggerClient from the browser expects 1 or 2 arguments: "name", and optional "args"'}P(e,f,[n,r],{noRet:1})}function G(e,n){if("unknown"===o)throw"Unknown RAGE environment";if(arguments.length<1||arguments.length>2)throw'triggerServer expects 1 or 2 arguments: "name", and optional "args"';k(f,[e,n],{noRet:1})}function M(e,n,r){if("unknown"===o)throw"Unknown RAGE environment";switch(o){case"client":case"cef":if(r=n,n=e,e=null,arguments.length<1||arguments.length>2)throw'triggerBrowsers from the client or browser expects 1 or 2 arguments: "name", and optional "args"';break;case"server":if(arguments.length<2||arguments.length>3)throw'triggerBrowsers from the server expects 2 or 3 arguments: "player", "name", and optional "args"'}P(e,g,[n,r],{noRet:1})}function L(e,n,r){if("unknown"===o)throw"Unknown RAGE environment";if("client"!==o)throw"callBrowser can only be used in the client environment";if(arguments.length<2||arguments.length>4)throw'callBrowser expects 2 or 3 arguments: "browser", "name", and optional "args"';B(e,f,[n,r],{noRet:1})}n.default={register:_,unregister:v,call:b,callServer:y,callClient:R,callBrowsers:j,callBrowser:E,on:C,off:S,trigger:U,triggerServer:G,triggerClient:A,triggerBrowsers:M,triggerBrowser:L}}.call(this,r(2))},function(e,n){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r}])}));